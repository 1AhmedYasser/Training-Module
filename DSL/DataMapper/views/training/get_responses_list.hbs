{
"responses": [
{{#each response}}
    {
    "name": "{{_id}}",
    "response": [
    {{#each _source.responses}}
        {
        "name": "{{@key}}",
        "text": "{{this.[0].text}}"
        }{{#unless @last}},{{/unless}}
    {{/each}}
    ]
    }{{#unless @last}},{{/unless}}
{{/each}}
]
}

{{!--


{{#*inline "json"}}
    {{toJSON this}}
{{/inline}}

{
"responses": [
{{#each response}}
    {
    "name": "{{_id}}",
    "response": [
    {{#each _source.responses}}
        {
        "name": "{{@key}}",
        "text": "{{this.[0].text}}",
        {{#if this.[0].buttons}}
            "buttons": {{{ toJSON this.[0].buttons }}},
        {{/if}}
        {{#if this.[0].condition}}
            "condition": {{{ toJSON this.[0].condition }}},
        {{/if}}
        }{{#unless @last}},{{/unless}}
    {{/each}}
    ]
    }{{#unless @last}},{{/unless}}
{{/each}}
]
}

{
"responses": [
{{#each response}}
    {
    "name": "{{_id}}",
    "response": [
    {{#each _source.responses}}
        {
        "name": "{{@key}}",
        "text": "{{this.[0].text}}",
        {{#if this.[0].buttons}}
            "buttons": [
            {{#each this.[0].buttons}}
                {
                "payload": "{{payload}}",
                "title": "{{title}}"
                }{{#unless @last}},{{/unless}}
            {{/each}}
            ],
        {{/if}}
        {{#if this.[0].condition}}
            "condition": [
            {{#each this.[0].condition}}
                {
                "name": "{{name}}",
                "type": "{{type}}",
                "value": "{{value}}"
                }{{#unless @last}},{{/unless}}
            {{/each}}
            ],
        {{/if}}
        }{{#unless @last}},{{/unless}}
    {{/each}}
    ]
    }{{#unless @last}},{{/unless}}
{{/each}}
]
}

--}}
